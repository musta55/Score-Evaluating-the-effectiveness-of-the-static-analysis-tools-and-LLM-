{
  "contract": "buggy_50.sol",
  "contract_name": "digitalNotary",
  "bug_type": "Re-entrancy",
  "findings": [
    {
      "bug_type": "Re-entrancy",
      "sub_type": "DAO",
      "severity": "Violation",
      "line_number": 6,
      "code_snippet": "bool success,) = msg.sender.call.value(_weiToWithdraw)(\"\");",
      "confidence": "high",
      "context_before": [
        "",
        "pragma solidity ^0.5.11;"
      ],
      "context_after": [
        "contract digitalNotary",
        "{"
      ]
    },
    {
      "bug_type": "Re-entrancy",
      "sub_type": "DAO",
      "severity": "Violation",
      "line_number": 11,
      "code_snippet": "(bool success,)= msg.sender.call.value(_weiToWithdraw)(\"\"));",
      "confidence": "high",
      "context_before": [
        "",
        "  address payable lastPlayer_re_ent2;"
      ],
      "context_after": [
        "\t  function buyTicket_re_ent2() public{",
        "\t    if (!(lastPlayer_re_ent2.send(jackpot_re_ent2)))"
      ]
    },
    {
      "bug_type": "Re-entrancy",
      "sub_type": "DAO",
      "severity": "Violation",
      "line_number": 16,
      "code_snippet": "require(msg.sender.send(_weiToWithdraw));",
      "confidence": "high",
      "context_before": [
        "        revert();",
        "      lastPlayer_re_ent2 = msg.sender;"
      ],
      "context_after": [
        "    }",
        "  address payable private manager;"
      ]
    },
    {
      "bug_type": "Re-entrancy",
      "sub_type": "DAO",
      "severity": "Violation",
      "line_number": 21,
      "code_snippet": "(uint transferValue_re_ent25) = redeemableEther_re_ent25[msg.sender];",
      "confidence": "high",
      "context_before": [
        "",
        "  mapping(address => uint) balances_re_ent17;"
      ],
      "context_after": [
        "        require(balances_re_ent17[msg.sender] >= _weiToWithdraw);",
        "        // limit the withdrawal"
      ]
    },
    {
      "bug_type": "Re-entrancy",
      "sub_type": "DAO",
      "severity": "Violation",
      "line_number": 26,
      "code_snippet": "require(msg.sender.send(_weiToWithdraw));",
      "confidence": "high",
      "context_before": [
        "        (bool success,)=msg.sender.call.value(_weiToWithdraw)(\"\");",
        "        require(success);  //bug"
      ],
      "context_after": [
        "    }",
        "  bool private contractactive;"
      ]
    },
    {
      "bug_type": "Re-entrancy",
      "sub_type": "DAO",
      "severity": "Violation",
      "line_number": 31,
      "code_snippet": "(bool success,) = msg.sender.call.value(balances_re_ent8[msg.sender])(\"\");",
      "confidence": "high",
      "context_before": [
        "",
        "  address payable lastPlayer_re_ent37;"
      ],
      "context_after": [
        "\t  function buyTicket_re_ent37() public{",
        "\t    if (!(lastPlayer_re_ent37.send(jackpot_re_ent37)))"
      ]
    },
    {
      "bug_type": "Re-entrancy",
      "sub_type": "DAO",
      "severity": "Violation",
      "line_number": 36,
      "code_snippet": "if (msg.sender.send(balances_re_ent36[msg.sender])) balances_re_ent36[msg.sender] = 0;",
      "confidence": "high",
      "context_before": [
        "        revert();",
        "      lastPlayer_re_ent37 = msg.sender;"
      ],
      "context_after": [
        "    }",
        "  uint private hashfee;"
      ]
    }
  ],
  "success": true,
  "improved_version": true,
  "multi_pass_enabled": true
}